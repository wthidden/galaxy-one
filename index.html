<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StarWeb Game</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- App Container (for login/lobby screens) -->
    <div id="app-container"></div>

    <!-- Login Overlay (legacy, will be replaced) -->
    <div id="login-overlay" style="display: none;">
        <div id="login-box">
            <h1>StarWeb</h1>
            <p>Enter your name and choose your path:</p>
            <div class="login-inputs">
                <input type="text" id="player-name-input" placeholder="Player Name" autofocus>
                <select id="character-type-select">
                    <option value="Empire Builder">üè≠ Empire Builder</option>
                    <option value="Merchant">üí∞ Merchant</option>
                    <option value="Pirate">‚ò†Ô∏è Pirate</option>
                    <option value="Artifact Collector">üîÆ Artifact Collector</option>
                    <option value="Berserker">‚öîÔ∏è Berserker</option>
                    <option value="Apostle">‚ú® Apostle</option>
                </select>
                <div id="character-synopsis">
                    <div class="character-quote"></div>
                    <div class="character-description"></div>
                    <div class="character-abilities"></div>
                </div>
                <input type="number" id="score-vote-input" placeholder="Suggest End Score (e.g., 8000)" value="8000">
            </div>
            <button id="join-btn">Join Game</button>
        </div>
    </div>

    <div id="game-container" style="display: none;">
        <div id="header">
            <h1>StarWeb</h1>
            <div id="character-badge" style="display: none;">
                <span id="character-badge-icon"></span>
                <span id="character-badge-name"></span>
            </div>
            <div id="resource-hud" style="display: none;">
                <div class="resource-item" title="Total Population">
                    <span class="resource-icon">üë•</span>
                    <span id="total-population">0</span>
                </div>
                <div class="resource-item" title="Total Industry">
                    <span class="resource-icon">üè≠</span>
                    <span id="total-industry">0</span>
                </div>
                <div class="resource-item" title="Total Metal">
                    <span class="resource-icon">‚öôÔ∏è</span>
                    <span id="total-metal">0</span>
                </div>
                <div class="resource-item" title="Total Ships">
                    <span class="resource-icon">üöÄ</span>
                    <span id="total-ships">0</span>
                </div>
            </div>
            <div id="timer-display">Turn 0 | 0:00 | 0/0 ready</div>
            <div id="header-controls">
                <button id="audio-toggle-btn" class="header-btn" title="Toggle sound effects">üîä</button>
                <button id="logout-btn" class="header-btn" title="Logout and clear saved session">üö™</button>
                <div id="connection-status">Connecting...</div>
            </div>
        </div>
        <div id="admin-message-panel" style="display: none;">
            <div id="admin-message-content"></div>
        </div>
        <div id="status-panel">Hover over a world to see details</div>
        <div id="main-content">
            <div id="left-sidebar" class="sidebar">
                <div id="scoreboard-section" class="sidebar-section">
                    <h3>Scoreboard</h3>
                    <div id="scoreboard" class="scrollable-list"></div>
                </div>
                <div id="my-worlds-section" class="sidebar-section flex-grow">
                    <div class="section-header">
                        <h3>My Worlds</h3>
                        <div class="filter-controls">
                            <button class="filter-btn active" data-filter="own" title="Show my worlds">Mine</button>
                            <button class="filter-btn" data-filter="all" title="Show all known worlds">All</button>
                            <button class="filter-btn" data-filter="neutral" title="Show neutral worlds">Neutral</button>
                            <button class="filter-btn" data-filter="enemy" title="Show enemy worlds">Enemy</button>
                        </div>
                    </div>
                    <div id="world-list" class="scrollable-list"></div>
                </div>
                <div id="my-fleets-section" class="sidebar-section flex-grow">
                    <div class="section-header">
                        <h3>My Fleets</h3>
                        <div class="filter-controls">
                            <button class="filter-btn active" data-filter="own" title="Show my fleets">Mine</button>
                            <button class="filter-btn" data-filter="all" title="Show all known fleets">All</button>
                        </div>
                    </div>
                    <div id="fleet-list" class="scrollable-list"></div>
                </div>
            </div>
            <div id="center-panel">
                <div id="canvas-container">
                    <canvas id="game-canvas"></canvas>
                </div>
                <div id="event-log-container">
                    <h3>Events</h3>
                    <div id="event-log"></div>
                </div>
            </div>
            <div id="right-sidebar" class="sidebar">
                <div id="queued-orders-section" class="sidebar-section flex-grow">
                    <h3>Orders This Turn</h3>
                    <div id="queued-orders" class="scrollable-list"></div>
                </div>
                <div id="selection-info-section" class="sidebar-section fixed-bottom">
                    <h3 id="selection-info-title">Selection Info</h3>
                    <div id="selection-info" class="scrollable-list">Click a world or fleet to see details</div>
                </div>
            </div>
        </div>
        <div id="controls-container">
            <div id="actions-section">
                <div id="action-list">Select an item to see actions.</div>
            </div>
            <div id="command-hint"></div>
            <div id="controls">
                <input type="text" id="command-input" placeholder="Enter command (e.g., F1W2, HELP, TURN)">
                <button id="help-btn" title="Show help">?</button>
                <button id="manual-btn" title="Download Player Manual">üìñ</button>
                <button id="bug-report-btn" title="Report a bug">üêõ</button>
                <button id="send-btn">Send</button>
            </div>
        </div>
        <div id="log"></div>
    </div>

    <!-- Download Modal -->
    <div id="download-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Download Documentation üìñ</h2>
            <p>Choose which document you'd like to download:</p>
            <div class="download-options">
                <button class="download-option-btn" data-url="/manual">
                    <div class="download-option-icon">üìò</div>
                    <div class="download-option-text">
                        <strong>Player Manual</strong>
                        <small>Complete game rules and mechanics</small>
                    </div>
                </button>
                <button class="download-option-btn" data-url="/commands">
                    <div class="download-option-icon">‚å®Ô∏è</div>
                    <div class="download-option-text">
                        <strong>Command Reference</strong>
                        <small>All commands with examples and strategies</small>
                    </div>
                </button>
                <button class="download-option-btn" data-url="/characters">
                    <div class="download-option-icon">üé≠</div>
                    <div class="download-option-text">
                        <strong>Character Guide</strong>
                        <small>Character backgrounds and gameplay strategies</small>
                    </div>
                </button>
            </div>
            <div class="modal-buttons">
                <button id="download-cancel-btn" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Bug Report Modal -->
    <div id="bug-report-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Report a Bug üêõ</h2>
            <p>Please describe the bug you encountered. Include what you were trying to do and what happened instead.</p>
            <textarea id="bug-description" rows="8" placeholder="Example: When I tried to move Fleet 5 to World 10, the fleet disappeared and I got an error message..."></textarea>
            <div class="modal-buttons">
                <button id="bug-submit-btn" class="primary-btn">Submit Report</button>
                <button id="bug-cancel-btn" class="secondary-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Keyboard Shortcuts Modal -->
    <div id="shortcuts-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>‚å®Ô∏è Keyboard Shortcuts</h2>
            <div class="shortcuts-grid">
                <div class="shortcut-section">
                    <h3>Navigation</h3>
                    <div class="shortcut-item">
                        <kbd>/</kbd>
                        <span>Focus command input</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>ESC</kbd>
                        <span>Clear command input</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>‚Üë</kbd> <kbd>‚Üì</kbd>
                        <span>Command history</span>
                    </div>
                </div>
                <div class="shortcut-section">
                    <h3>Game Actions</h3>
                    <div class="shortcut-item">
                        <kbd>T</kbd>
                        <span>End turn</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>H</kbd> or <kbd>?</kbd>
                        <span>Show help / shortcuts</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>M</kbd>
                        <span>Download manual</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>A</kbd>
                        <span>Toggle audio</span>
                    </div>
                </div>
                <div class="shortcut-section">
                    <h3>Filters</h3>
                    <div class="shortcut-item">
                        <kbd>1</kbd>
                        <span>My worlds</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>2</kbd>
                        <span>All worlds</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>3</kbd>
                        <span>Neutral worlds</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>4</kbd>
                        <span>Enemy worlds</span>
                    </div>
                </div>
            </div>
            <div class="modal-buttons">
                <button id="shortcuts-close-btn" class="secondary-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Modular JavaScript Architecture -->
    <!-- Data -->
    <script src="client/data/CharacterData.js"></script>

    <!-- Audio System -->
    <script src="client/audio/AudioManager.js"></script>

    <!-- State Management -->
    <script src="client/state/GameState.js"></script>

    <!-- Network Layer -->
    <script src="client/network/WebSocketClient.js"></script>
    <script src="client/network/MessageHandler.js"></script>

    <!-- Rendering System -->
    <script src="client/rendering/Camera.js"></script>
    <script src="client/utils/WorldLayout.js"></script>
    <script src="client/rendering/layers/BaseLayer.js"></script>
    <script src="client/rendering/layers/BackgroundLayer.js"></script>
    <script src="client/rendering/layers/ConnectionLayer.js"></script>
    <script src="client/rendering/layers/WorldLayer.js"></script>
    <script src="client/rendering/layers/FleetLayer.js"></script>
    <script src="client/rendering/layers/OrderIndicatorsLayer.js"></script>
    <script src="client/rendering/Renderer.js"></script>

    <!-- UI Panels -->
    <script src="client/ui/Scoreboard.js"></script>
    <script src="client/ui/WorldList.js"></script>
    <script src="client/ui/FleetList.js"></script>
    <script src="client/ui/QueuedOrders.js"></script>
    <script src="client/ui/WorldInfo.js"></script>
    <script src="client/ui/FleetInfo.js"></script>
    <script src="client/ui/ActionList.js"></script>
    <script src="client/ui/CommandHint.js"></script>
    <script src="client/ui/ToastManager.js"></script>
    <script src="client/ui/ModalManager.js"></script>
    <script src="client/ui/KeyboardNav.js"></script>

    <!-- Command Parser System -->
    <script src="client/commands/tokenizer/TokenTypes.js"></script>
    <script src="client/commands/tokenizer/Tokenizer.js"></script>
    <script src="client/commands/parser/CommandAST.js"></script>
    <script src="client/commands/parser/CommandGrammar.js"></script>
    <script src="client/commands/parser/Parser.js"></script>
    <script src="client/commands/validator/ValidationResult.js"></script>
    <script src="client/commands/validator/ValidationRules.js"></script>
    <script src="client/commands/validator/Validator.js"></script>
    <script src="client/commands/suggester/FuzzyMatcher.js"></script>
    <script src="client/commands/suggester/AutoComplete.js"></script>
    <script src="client/commands/history/HistoryStorage.js"></script>
    <script src="client/commands/history/CommandHistory.js"></script>
    <script src="client/commands/CommandParser.js"></script>
    <script src="client/ui/CommandInput.js"></script>

    <!-- Auth & Lobby Screens -->
    <script src="client/screens/LoginScreen.js"></script>
    <script src="client/screens/LobbyScreen.js"></script>

    <!-- App Controller (handles screen routing) -->
    <script src="client/app.js"></script>

    <!-- Main Entry Point (game screen) -->
    <script src="client/main.js"></script>
</body>
</html>
